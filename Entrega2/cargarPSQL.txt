#local jirojas, en server usar db grupo118e2

CREATE DATABASE entrega2;
\c entrega2;

CREATE TABLE Pais(pais_id INT, pais_nombre VARCHAR(30), PRIMARY KEY(pais_id));
\COPY Pais from 'Pais.csv' DELIMITER ',' CSV HEADER;

CREATE TABLE Naviera(nav_id INT,nav_nombre VARCHAR(40), giro VARCHAR(50), pais_id INT, FOREIGN KEY(pais_id) REFERENCES Pais, PRIMARY KEY (nav_id));
\COPY Naviera from 'Naviera.csv' DELIMITER ',' CSV HEADER;

CREATE TABLE Buque(buq_id INT, buq_nombre VARCHAR(30), patente VARCHAR(30), nav_id INT, pais_id INT, FOREIGN KEY(nav_id) REFERENCES Naviera, FOREIGN KEY(pais_id) REFERENCES Pais, PRIMARY KEY (buq_id));
\COPY Buque from 'Buque.csv' DELIMITER ',' CSV HEADER;

CREATE TABLE BuquePesquero(bpes_id INT, buq_id INT, tipo_pesca VARCHAR(30), FOREIGN KEY(buq_id) REFERENCES Buque, PRIMARY KEY (bpes_id));
\COPY BuquePesquero from 'BuquePesquero.csv' DELIMITER ',' CSV HEADER;

CREATE TABLE BuqueCarga(bcar_id INT, buq_id INT, max_containers INT, max_toneladas INT, FOREIGN KEY(buq_id) REFERENCES Buque, PRIMARY KEY (bcar_id));
\COPY BuqueCarga from 'BuqueCarga.csv' DELIMITER ',' CSV HEADER;

CREATE TABLE BuquePetrolero(bpet_id INT, buq_id INT, max_litros INT, FOREIGN KEY(buq_id) REFERENCES Buque, PRIMARY KEY (bpet_id));
\COPY BuquePetrolero from 'BuquePetrolero.csv' DELIMITER ',' CSV HEADER;

CREATE TABLE Personal(per_id INT, per_nombre VARCHAR(50), nacionalidad VARCHAR(30), pasaporte VARCHAR(30), edad INT, genero VARCHAR(30), buq_id INT, cargo VARCHAR(30), FOREIGN KEY(buq_id) REFERENCES Buque, PRIMARY KEY(per_id));
\COPY Personal from 'Personal.csv' DELIMITER ',' CSV HEADER;

CREATE TABLE Puerto(puerto_id INT, puerto_nombre VARCHAR(30), PRIMARY KEY(puerto_id));
\COPY Puerto from 'Puerto.csv' DELIMITER ',' CSV HEADER;

CREATE TABLE Itinerario(it_id INT, fecha_llegada TIMESTAMP, buq_id INT, puerto_id INT, FOREIGN KEY(buq_id) REFERENCES Buque, FOREIGN KEY(puerto_id) REFERENCES Puerto, PRIMARY KEY(it_id));
\COPY Itinerario from 'Itinerario.csv' DELIMITER ',' CSV HEADER;

CREATE TABLE Atraque(atr_id INT, fecha_atraque TIMESTAMP, fecha_salida TIMESTAMP, buq_id INT, puerto_id INT, FOREIGN KEY(buq_id) REFERENCES Buque, FOREIGN KEY(puerto_id) REFERENCES Puerto, PRIMARY KEY(atr_id));
\COPY Atraque from 'Atraque.csv' DELIMITER ',' CSV HEADER;

#para ver constraints (primary y foreign keys)
SELECT constraint_name, table_name, column_name, ordinal_position FROM information_schema.key_column_usage WHERE table_name = 'atraque';